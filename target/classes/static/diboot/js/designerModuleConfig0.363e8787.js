(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["designerModuleConfig0"],{"0700":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form",{attrs:{layout:"horizontal"}},[n("a-tag",{staticStyle:{"max-width":"300px","white-space":"initial"},attrs:{color:"orange"}},[e._v("\n      ⚠：️当前组件设计器中，展示为PC组件效果，实际生成为移动端组件！\n    ")]),n("h3",{staticClass:"title separator"},[e._v("详细头部设置")]),n("a-row",[n("a-col",{attrs:{span:6}},[e._v("\n        启用表头\n      ")]),n("a-col",{attrs:{span:18}},[n("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关"},on:{change:e.handleCloseHeaderConfig},model:{value:e.moduleConfig.metadata.header.setting,callback:function(t){e.$set(e.moduleConfig.metadata.header,"setting",t)},expression:"moduleConfig.metadata.header.setting"}})],1)],1),e.moduleConfig.metadata.header.setting?n("a-row",{staticStyle:{"margin-top":"10px"}},[n("a-col",{attrs:{offset:"2",span:4}},[e._v("\n        左侧\n      ")]),n("a-col",{attrs:{span:18}},[n("a-row",[n("a-col",{attrs:{span:8}},[e._v("\n            显示字段\n          ")]),n("a-col",{attrs:{span:16}},[n("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:""},model:{value:e.moduleConfig.metadata.header.left.fieldName,callback:function(t){e.$set(e.moduleConfig.metadata.header.left,"fieldName",t)},expression:"moduleConfig.metadata.header.left.fieldName"}},e._l(e.freezeColumns,function(t,a){return n("a-select-option",{key:"general-list-header-left_"+a,attrs:{value:t.fieldName}},[e._v("\n                "+e._s(t.fieldLabel)+"\n              ")])}),1)],1)],1),n("a-row",{staticStyle:{"margin-top":"10px"}},[n("a-col",{attrs:{span:8}},[e._v("\n            显示为标签\n          ")]),n("a-col",{attrs:{span:16}},[n("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否"},model:{value:e.moduleConfig.metadata.header.left.isTag,callback:function(t){e.$set(e.moduleConfig.metadata.header.left,"isTag",t)},expression:"moduleConfig.metadata.header.left.isTag"}})],1)],1)],1),n("a-col",{staticStyle:{"margin-top":"10px"},attrs:{offset:"2",span:4}},[e._v("\n        右侧\n      ")]),n("a-col",{staticStyle:{"margin-top":"10px"},attrs:{span:18}},[n("a-row",[n("a-col",{attrs:{span:8}},[e._v("\n            显示字段\n          ")]),n("a-col",{attrs:{span:16}},[n("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:""},model:{value:e.moduleConfig.metadata.header.right.fieldName,callback:function(t){e.$set(e.moduleConfig.metadata.header.right,"fieldName",t)},expression:"moduleConfig.metadata.header.right.fieldName"}},e._l(e.freezeColumns,function(t,a){return n("a-select-option",{key:"general-list-header-right_"+a,attrs:{value:t.fieldName}},[e._v("\n                "+e._s(t.fieldLabel)+"\n              ")])}),1)],1)],1),n("a-row",{staticStyle:{"margin-top":"10px"}},[n("a-col",{attrs:{span:8}},[e._v("\n            显示为标签\n          ")]),n("a-col",{attrs:{span:16}},[n("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否"},model:{value:e.moduleConfig.metadata.header.right.isTag,callback:function(t){e.$set(e.moduleConfig.metadata.header.right,"isTag",t)},expression:"moduleConfig.metadata.header.right.isTag"}})],1)],1)],1)],1):e._e(),n("column-list-selector-plus",{ref:"columnListSelector",attrs:{"need-ref-entity":!0,"valid-columns-filter":e.validColumnsFilter,title:"详情项配置","vo-type":"DetailVO","is-expand":!0,"col-extra-properties-setter":e.setColExtraProperties,"expand-columns-filter":e.expandColumnsFilter,"auto-setter-col-filter":e.autoSetterColFilter},on:{freezeColumns:function(t){e.freezeColumns=e._.cloneDeep(t)},change:function(t){e.moduleConfig.metadata.columns=e._.cloneDeep(t)}}})],1)},o=[],i=n("7618"),r=(n("7514"),n("a979")),l=n("4047"),c={name:"DetailPanelConfig",data:function(){return{initColumns:void 0,freezeColumns:[],defaultHeader:{setting:!1,left:{isTag:!1,column:null},right:{isTag:!1,column:null}}}},methods:{handleCloseHeaderConfig:function(e){e||this.$set(this.moduleConfig.metadata,"header",this.defaultHeader)},setColExtraProperties:function(e){e.actionType="",e.qrCodeSize=120},expandColumnsFilter:function(e){return!1},validColumnsFilter:function(e){return"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&!e.columnExt.refType},autoSetterColFilter:function(e){return!0!==e.primaryKey&&"tenantId"!==e.fieldName},getHeaderColumn:function(e){var t=null;if(e&&(t=this.freezeColumns.find(function(t){return t.fieldName===e})),t&&("Date"===t.fieldPackagingType||t.columnExt&&"DATETIMEPICKER"===t.columnExt.formType||t.columnExt&&"DATEPICKER"===t.columnExt.formType)&&t.example&&"object"===Object(i["a"])(t.example)){var n="DATETIMEPICKER"===t.columnExt.formType?"YYYY-MM-DD hh:mm":"YYYY-MM-DD";t.example=t.example.format(n)}return t}},watch:{"moduleConfig.metadata.header.left.fieldName":function(e){this.$set(this.moduleConfig.metadata.header.left,"column",this.getHeaderColumn(e))},"moduleConfig.metadata.header.right.fieldName":function(e){this.$set(this.moduleConfig.metadata.header.right,"column",this.getHeaderColumn(e))}},mixins:[r["a"]],components:{columnListSelectorPlus:l["a"]},created:function(){console.log("detail panel created");var e=this.moduleConfig.metadata.columns;this.initColumns=e.length>0?e:void 0},mounted:function(){var e=this;this.$nextTick(function(){e.initColumns&&e.$refs.columnListSelector.setResultColumns(e.initColumns)})}},s=c,u=(n("19ed"),n("2877")),d=Object(u["a"])(s,a,o,!1,null,"392c5bdc",null);t["default"]=d.exports},"119f":function(e,t,n){"use strict";var a=n("b97a"),o=n.n(a);o.a},"12e6":function(e,t,n){},"19ed":function(e,t,n){"use strict";var a=n("9375"),o=n.n(a);o.a},"231b":function(e,t,n){},"37c8":function(e,t,n){t.f=n("2b4c")},"3a72":function(e,t,n){var a=n("7726"),o=n("8378"),i=n("2d00"),r=n("37c8"),l=n("86cc").f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:a.Symbol||{});"_"==e.charAt(0)||e in t||l(t,e,{value:r.f(e)})}},"3e9c":function(e,t,n){"use strict";n.d(t,"a",function(){return o});n("6762"),n("2fdb"),n("a481"),n("7514"),n("ac6a");var a=n("77db"),o=[{name:"显示关联子列表",mark:"abstractPanel",key:"subList4detailPage",type:"entityList",comment:"关联子列表组件引入",codeTmpl:"{instClassName}EntityList",nameTmpl:"{objName}实体列表",permissions:["detail"],panelCode:"notNullSearchFieldNoneSearchLineList",execFuncList:[],modelGetterList:["getRelationChildren"],checkFunc:function(){},isValid:function(e){return e.refChildren&&e.refChildren.length>0},panelConfigMapAutoSetter:function(e){for(var t in e){var n=e[t],a=n.mark,o=n.metadata;"generalList"===a&&(o.getListFromMixin=!1)}},columnsConfig:{searchColumns:{},listColumns:{filter:function(e){return"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&"S_FILE_UPLOAD"!==e.columnExt.formType&&"M_FILE_UPLOAD"!==e.columnExt.formType&&"S_IMG_UPLOAD"!==e.columnExt.formType&&"M_IMG_UPLOAD"!==e.columnExt.formType&&"RICH_EDITOR"!==e.columnExt.formType&&!e.columnExt.refType},isExpand:!1,voType:"ListVO"}},valueGetterFunc:{showSearch:{origin:"getRelationChildren",getDefaultValue:function(e){return!1}},entity_without_sys:{origin:"getRelationChildren",getDefaultValue:function(e){console.log("getDefaultValue model",e);var t=e.refChildren;return t&&t.length>0?t[0]["refTableInfo"]["tableName"]:""},getOptions:function(e){console.log("getOptions model",e);var t=e.refChildren;return t&&t.length>0?t.map(function(e){return e.refTableInfo}):[]}}},propsSetter:function(e,t){var n=t.mainTableName,o=t.columns;e.forEach(function(e){var t=e.key;if("searchId"===t)e.open=!0,e.convertToString=!0,e.onlyDataShow=!0,e.targetData="model.id";else if("searchField"===t){var i=o.find(function(e){if(!e.columnExt)return!1;var t=e.columnExt,a=t.refType,o=t.refTable;return"T"===a&&o===n});i&&(e.open=!0,e.convertToString=!0,e.onlyDataShow=!1,e.targetData="'".concat(Object(a["b"])(i.colName),"'"))}})}},{name:"添加关联子表单（单记录）",mark:"abstractPanel",key:"subForm4formPage",type:"singleSubForm",tips:"生成后请完善当前实体的新建/更新接口",tipUrl:"https://www.diboot.com/guide/diboot-devtools/faq.html",codeTmpl:"{instClassName}SubForm",nameTmpl:"{objName}子表单",permissions:["form"],panelCode:"singleCreateSubForm_#{projectType}",execFuncList:[],modelGetterList:["getRelationChildren"],checkFunc:function(){},isValid:function(e){var t=e.refChildren;if(!t||0===t.length)return!1;var n=t.some(function(e){var t=e.referenceField;return!(!t||"1-1"!==t.refRelationship)});return n},containerConfigAutoSetter:function(e){var t;console.log("containerConfigAutoSetter",e);var n=e.scriptConfig,a=e.metadata,o=n.props,i=n.event;a.panelConfig.keyFieldName="state.visible",o&&o.length>0&&o.forEach(function(e){var t=e.key;"queryModel"===t&&(e.open=!0,e.targetData="form.id === undefined ? undefined : {employeeId: form.id}")});var r=a.panelConfig.refName,l=r.replace("SubForm","List"),c=[{handlerCode:"afterOpen(id) {\n      this.$nextTick(() => {\n        this.$refs.".concat(r,".initForm()\n      })\n    }"),handlerFuncName:"afterOpen",key:"afterOpen",name:"表单打开后钩子函数",open:!0,bindIgnore:!0,params:[]},{handlerCode:"async enhance(values) {\n      const ".concat(l," = await this.$refs.").concat(r,".getFormDataList()\n      values.").concat(l," = ").concat(l,"\n    }"),handlerFuncName:"enhance",key:"enhance",name:"提交前对数据对额外处理",open:!0,bindIgnore:!0,params:[]}],s=c.map(function(e){return e.key});n.event=i.filter(function(e){return!s.includes(e.key)}),(t=n.event).push.apply(t,c)},panelConfigMapAutoSetter:function(e){for(var t in e){var n=e[t],a=n.mark,o=n.preview,i=n.scriptConfig;if("generalForm"===a&&!0!==o){var r=i.event;r.push.apply(r,[{handlerCode:"async initForm() {\n      this.clearForm()\n      const { queryModel } = this\n      if (queryModel === undefined) {\n        return false\n      }\n      for (const key in queryModel) {\n        if (!queryModel[key]) {\n          delete queryModel[key]\n        }\n      }\n      if (Object.keys(queryModel).length === 0) {\n        return false\n      }\n      // 通过查询条件获取列表\n      const res = await dibootApi.get(`${this.baseApi}/list`, queryModel)\n      if (res.code === 0) {\n        const dataList = res.data\n        if (dataList && dataList.length > 0) {\n          // 将列表数据赋值给表单\n          this.form = dataList[0]\n        }\n      }\n    }",handlerFuncName:"initForm",key:"initForm",name:"初始化/加载表单数据",open:!0,params:[]},{handlerCode:"async getFormDataList() {\n      const values = await this.validate()\n      this.enhance(values)\n      return [values]\n    }",handlerFuncName:"getFormDataList",key:"getFormDataList",name:"获取表单数据列表",open:!0,params:[]}]),i.event=r.filter(function(e){return!["submit","submitSuccess"].includes(e.key)})}}},columnsConfig:{columns:{filter:function(e,t){var n="id"!==e.fieldName&&"uuid"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&"createTime"!==e.fieldName&&"updateTime"!==e.fieldName&&"createBy"!==e.fieldName&&"updateBy"!==e.fieldName;if(void 0===t)return n;var a=t.pageTableName;if(void 0===a)return n;var o=e.columnExt;return n=n&&!(void 0!==o&&"T"===o.refType&&o.refTable===a),n},isExpand:!0,voType:""}},valueGetterFunc:{showSearch:{origin:"getRelationChildren",getDefaultValue:function(e){return!1}},entity_without_sys:{origin:"getRelationChildren",getDefaultValue:function(e){console.log("getDefaultValue model",e);var t=e.refChildren;if(t&&t.length>0){var n=t.filter(function(e){var t=e.referenceField;return!(!t||"1-1"!==t.refRelationship)});return n[0]["refTableInfo"]["tableName"]}return""},getOptions:function(e){console.log("getOptions model",e);var t=e.refChildren;if(t&&t.length>0){var n=t.filter(function(e){var t=e.referenceField;return!(!t||"1-1"!==t.refRelationship)});return n.map(function(e){return e.refTableInfo})}return[]}}}},{name:"添加关联子表单（多记录）",mark:"abstractPanel",key:"multiSubForm4formPage",type:"multiSubForm",codeTmpl:"{instClassName}MultiSubForm",nameTmpl:"{objName}子表单",permissions:["form"],panelCode:"multiUpdateSubForm",execFuncList:[],modelGetterList:["getRelationChildren"],checkFunc:function(){},isValid:function(e){var t=e.refChildren;if(!t||0===t.length)return!1;var n=t.some(function(e){var t=e.referenceField;return!(!t||"n-1"!==t.refRelationship)});return n},containerConfigAutoSetter:function(e,t){var n,a=e.scriptConfig,o=e.metadata,i=a.props,r=a.event;o.panelConfig.keyFieldName="state.visible",i&&i.length>0&&i.forEach(function(e){var n=e.key;if("queryModel"===n){e.open=!0;var a="antdv",o="parentId";if(void 0!==t){var i=t.pageTableName,r=t.columns,l=t.projectType;if(l&&(a=l),i&&r){var c=r.find(function(e){return e.columnExt&&"T"===e.columnExt.refType&&e.columnExt.refTable===i});void 0!==c&&(o=c.fieldName)}}var s="antdv"===a?"model":"form";e.targetData="".concat(s,"[primaryKey] === undefined ? undefined : {").concat(o,": ").concat(s,"[primaryKey]}")}});var l=o.panelConfig.refName,c=l.replace("SubForm","List"),s=[{handlerCode:"afterOpen(id) {\n      this.$nextTick(() => {\n        this.$refs.".concat(l,".initForm()\n      })\n    }"),handlerFuncName:"afterOpen",key:"afterOpen",name:"表单打开后钩子函数",open:!0,bindIgnore:!0,params:[]},{handlerCode:"async enhance(values) {\n      const ".concat(c," = await this.$refs.").concat(l,".getFormDataList()\n      values.").concat(c," = ").concat(c,"\n    }"),handlerFuncName:"enhance",key:"enhance",name:"提交前对数据对额外处理",open:!0,bindIgnore:!0,params:[]}],u=s.map(function(e){return e.key});a.event=r.filter(function(e){return!u.includes(e.key)}),(n=a.event).push.apply(n,s),o.panelConfig.scriptConfig=a},panelConfigMapAutoSetter:function(e){for(var t in e){var n=e[t],a=n.mark,o=n.preview,i=n.scriptConfig,r=n.metadata;if("multiForm"===a&&!0!==o){var l=i.event;l.push.apply(l,[{handlerCode:"async getFormDataList () {\n      await this.validate()\n      return this.dataList\n    }",handlerFuncName:"getFormDataList",key:"getFormDataList",name:"获取表单数据列表",open:!0,params:[]}]),i.event=l.filter(function(e){return!["submit","submitSuccess"].includes(e.key)}),r.refSource="multiSubForm4formPage"}}},columnsConfig:{columns:{filter:function(e,t){var n="id"!==e.fieldName&&"uuid"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&"createTime"!==e.fieldName&&"updateTime"!==e.fieldName&&"createBy"!==e.fieldName&&"updateBy"!==e.fieldName&&!["M_FILE_UPLOAD","S_FILE_UPLOAD","M_IMG_UPLOAD","S_IMG_UPLOAD","RICH_EDITOR"].includes(e.columnExt.formType);if(void 0===t)return n;var a=t.pageTableName;if(void 0===a)return n;var o=e.columnExt;return n=n&&!(void 0!==o&&"T"===o.refType&&o.refTable===a),n},isExpand:!1,voType:""}},valueGetterFunc:{entity_without_sys:{origin:"getRelationChildren",getDefaultValue:function(e){console.log("getDefaultValue model",e);var t=e.refChildren;if(t&&t.length>0){var n=t.filter(function(e){var t=e.referenceField;return!(!t||"n-1"!==t.refRelationship)});return n[0]["refTableInfo"]["tableName"]}return""},getOptions:function(e){console.log("getOptions model",e);var t=e.refChildren;if(t&&t.length>0){var n=t.filter(function(e){var t=e.referenceField;return!(!t||"n-1"!==t.refRelationship)});return n.map(function(e){return e.refTableInfo})}return[]}}}},{name:"列表左侧关联树结构",mark:"abstractPanel",key:"tree4listPage",type:"entityList",comment:"列表左侧关联树结构引入",codeTmpl:"{instClassName}Tree",nameTmpl:"{objName}树结构",permissions:["list"],panelCode:"abstractGeneralTree",execFuncList:[],modelGetterList:["getTreeRefs"],checkFunc:function(){},isValid:function(e){return e.treeRefs&&e.treeRefs.length>0},containerConfigAutoSetter:function(e,t){var n,a=e.scriptConfig,o=a.event,i="";if(void 0!==t){var r=t.pageColumns,l=t.tableName;if(l&&r&&r.length>0){var c=r.find(function(e){return e.columnExt&&e.columnExt.refTable===l});void 0!==c&&(i=c.fieldName)}}var s=[{handlerCode:"onCurrentNodeChanged (val) {\n      this.customQueryParam.".concat(i," = val\n      this.getList()\n    }"),handlerFuncName:"onCurrentNodeChanged",key:"currentNodeChange",name:"当前节点变更事件处理",open:!0,params:[{key:"value",name:"参数",type:"String"}]}],u=s.map(function(e){return e.key});a.event=o.filter(function(e){return!u.includes(e.key)}),(n=a.event).push.apply(n,s)},panelConfigMapAutoSetter:function(e){for(var t in e){var n=e[t],a=n.mark,o=n.metadata;"treeStruct"===a&&(o.tableName=o.treeTable&&o.treeTable.tableName?o.treeTable.tableName:"")}},valueGetterFunc:{entity_without_sys:{origin:"getTreeRefs",getDefaultValue:function(e){var t=e.treeRefs;return t&&t.length>0?t[0]["refTableInfo"]["tableName"]:""},getOptions:function(e){var t=e.treeRefs;return t&&t.length>0?t.map(function(e){return e.refTableInfo}):[]}}},propsSetter:function(e,t){var n=t.mainTableName,o=t.columns;e.forEach(function(e){var t=e.key;if("searchId"===t)e.open=!0,e.convertToString=!0,e.onlyDataShow=!0,e.targetData="model.id";else if("searchField"===t){var i=o.find(function(e){if(!e.columnExt)return!1;var t=e.columnExt,a=t.refType,o=t.refTable;return"T"===a&&o===n});i&&(e.open=!0,e.convertToString=!0,e.onlyDataShow=!1,e.targetData="'".concat(Object(a["b"])(i.colName),"'"))}})}}]},"58de":function(e,t,n){"use strict";var a=n("ce8f"),o=n.n(a);o.a},5903:function(e,t,n){"use strict";var a=n("12e6"),o=n.n(a);o.a},"5f70":function(e,t,n){"use strict";n.d(t,"a",function(){return a});n("ac6a");var a=function(e){var t={};return e&&0!==e.length?(e.forEach(function(e){var n=e.fieldName,a=e.fieldPackagingType,o=e.defaultValue,i="Boolean"!==a&&"";i=void 0===o||""===o?i:o,t[n]=i}),t):t}},"67ab":function(e,t,n){var a=n("ca5a")("meta"),o=n("d3f4"),i=n("69a8"),r=n("86cc").f,l=0,c=Object.isExtensible||function(){return!0},s=!n("79e5")(function(){return c(Object.preventExtensions({}))}),u=function(e){r(e,a,{value:{i:"O"+ ++l,w:{}}})},d=function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,a)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[a].i},f=function(e,t){if(!i(e,a)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[a].w},m=function(e){return s&&p.NEED&&c(e)&&!i(e,a)&&u(e),e},p=e.exports={KEY:a,NEED:!1,fastKey:d,getWeak:f,onFreeze:m}},"7bbc":function(e,t,n){var a=n("6821"),o=n("9093").f,i={}.toString,r="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(e){try{return o(e)}catch(t){return r.slice()}};e.exports.f=function(e){return r&&"[object Window]"==i.call(e)?l(e):o(a(e))}},8432:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={updateRecord:["idList"],batchUpdateRecord:["id"],createRecord:["id","idList"]}},"85e1":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form-model",{ref:"form",attrs:{layout:"horizontal",rules:e.rules,"label-col":{span:6},"wrapper-col":{span:18},model:e.moduleConfig.metadata}},[e.abstractPanel?[n("a-form-model-item",{attrs:{label:"实体选择"}},[n("a-tag",{attrs:{color:"#87d068"}},[e._v("\n        表单实体预留\n      ")])],1)]:[n("a-form-model-item",{attrs:{label:"实体选择",prop:"tableName"}},[e.listTables.length>0?[n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":e.filterOption,"default-value":e.listTables[e.listTables.length-1]["tableName"]},on:{change:function(t){return e.listTableNameChanged(t)}},model:{value:e.moduleConfig.metadata.tableName,callback:function(t){e.$set(e.moduleConfig.metadata,"tableName",t)},expression:"moduleConfig.metadata.tableName"}},e._l(e.listTables,function(t,a){return n("a-select-option",{key:a,attrs:{value:t.tableName}},[e._v("\n            "+e._s(t.objName)+" ["+e._s(t.tableName)+"]\n          ")])}),1)]:n("span",[e._v("\n        暂无实体可选\n      ")])],2)],n("a-form-model-item",{attrs:{label:"表单模式",prop:"formType"}},[n("a-select",{staticStyle:{width:"100%"},on:{change:e.switchFormType},model:{value:e.moduleConfig.metadata.formType,callback:function(t){e.$set(e.moduleConfig.metadata,"formType",t)},expression:"moduleConfig.metadata.formType"}},e._l(e.formTypeKeys,function(t,a){return n("a-select-option",{key:a,attrs:{value:t}},[e._v("\n        "+e._s(e.formTypeCons[t])+"\n      ")])}),1)],1),e.abstractPanel?[n("a-form-model-item",{attrs:{label:"布局列数"}},[n("a-tag",{attrs:{color:"#87d068"}},[e._v("\n        布局列数预留\n      ")])],1)]:[n("a-form-model-item",{attrs:{label:"布局列数",prop:"colNumber"}},[n("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.moduleConfig.metadata.colNumber,callback:function(t){e.$set(e.moduleConfig.metadata,"colNumber",t)},expression:"moduleConfig.metadata.colNumber"}},e._l([1,2,3,4],function(t){return n("a-radio-button",{key:t,attrs:{value:t}},[e._v("\n          "+e._s(t)+"\n        ")])}),1)],1)],n("a-form-model-item",{attrs:{label:"提交按钮"}},[n("a-switch",{attrs:{"checked-children":"显示","un-checked-children":"隐藏"},model:{value:e.moduleConfig.metadata.showSubmitBtn,callback:function(t){e.$set(e.moduleConfig.metadata,"showSubmitBtn",t)},expression:"moduleConfig.metadata.showSubmitBtn"}})],1),e.abstractPanel?[n("h3",{staticClass:"title separator"},[e._v("表单字段配置")]),n("a-tag",{attrs:{color:"#87d068"}},[e._v("\n      表单字段预留\n    ")])]:[e.listColumns.length>0?n("column-list-selector-plus",{ref:"columnListSelector",attrs:{value:e.moduleConfig.metadata.columns,title:"表单项配置","is-expand":!0,"init-columns":e.listColumns,"primary-key-event":!0,"need-ref-entity":!1,"valid-columns-filter":e.validListColumnsFilter,"col-extra-properties-setter":e.setColExtraProperties,"expand-columns-filter":e.expandColumnsFilter,"auto-setter-col-filter":e.autoSetterColFilter},on:{primaryKeyChange:function(t){return e.moduleConfig.metadata.primaryKey=t},change:e.onColumnsSelectorChange},scopedSlots:e._u([{key:"item-extra-content",fn:function(t){var a=t.col;return[n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"事件"}},[n("a-radio-group",{on:{change:function(t){return e.onColActionTypeChange(t.target.value,a)}},model:{value:a.actionType,callback:function(t){e.$set(a,"actionType",t)},expression:"col.actionType"}},[n("a-radio",{attrs:{value:""}},[e._v("\n              无\n            ")]),n("a-radio",{attrs:{value:"btnPopWindow"}},[e._v("\n              按钮打开面板弹窗\n            ")])],1)],1),"btnPopWindow"===a.actionType?n("btn-pop-window-panel-selector",{attrs:{code:e.code,"project-type":e.projectType,"btn-window-data-list":e.btnWindowDataList,"panel-list":e.panelList,"extract-all-btn-window-methods":e.extractAllBtnWindowMethods,workspace:e.workspace},on:{updatePanelList:function(t){return e.panelList=t},change:e.onBtnWindowDataChange},model:{value:a.btnWindowData,callback:function(t){e.$set(a,"btnWindowData",t)},expression:"col.btnWindowData"}}):e._e()]}}],null,!1,2095385627)}):e._e()],e.moduleConfig.scriptConfig&&e.hasPermission("f_pc_panel_event_kit")?[n("h3",{staticClass:"title separator"},[e._v("组件事件处理")]),n("event-kit",{attrs:{code:e.code,"script-config":e.moduleConfig.scriptConfig}})]:e._e()],2)},o=[],i=(n("456d"),n("7514"),n("a481"),n("75fc")),r=(n("ac6a"),n("7f57")),l=n("4047"),c=n("8656"),s=n("3aa3"),u=n("6892"),d=n("8432"),f=n("c5e9"),m=n("01bc"),p=n("2ef0"),h=n.n(p),g=n("b023"),b=[{uuid:"",moduleName:"generalForm",label:"表单参数设置",type:"dynamic_table_fields",strategy:{label:"列表实体选择",type:g["b"].entity_without_sys,target:"tableName",tableInfoTarget:"tableObj",custom:!0,children:[{label:"表单字段列表",type:"columns",name:"columns",strategy:{label:"表单字段列表",type:g["a"].filter,custom:!0,target:"columns"}}]}}],v={name:"GeneralFormConfig",data:function(){return{listTables:[],treeColumns:[],listColumns:[],panelList:void 0,rules:{tableName:[{required:!0,message:"请选择列表实体",trigger:"blur"}]},formTypeCons:{updateRecord:"单条更新",batchUpdateRecord:"批量更新",createRecord:"单条新建"}}},methods:{getAbstractStrategys:function(){return b},setColExtraProperties:function(e){e.actionType="",e.btnWindowData=void 0},onColActionTypeChange:function(e,t){t.btnWindowData={}},onColumnsSelectorChange:function(e){this.moduleConfig.metadata.columns=h.a.cloneDeep(e)},onBtnWindowDataChange:function(){var e=this.moduleConfig.scriptConfig.methods.filter(function(e){return"panelExtractor"!==e.origin});this.moduleConfig.metadata.columns.forEach(function(t){"btnPopWindow"===t.actionType&&t.btnWindowData&&t.btnWindowData.panelConfig&&t.btnWindowData.panelConfig.scriptConfig&&t.btnWindowData.panelConfig.scriptConfig.methods&&e.push.apply(e,Object(i["a"])(t.btnWindowData.panelConfig.scriptConfig.methods))}),this.moduleConfig.scriptConfig.methods=e},extractAllBtnWindowMethods:function(){return Object(m["a"])(this.btnWindowDataList)},switchFormType:function(e){var t,n={updateRecord:[{key:"open",name:"打开表单",params:[{key:"id",name:"当前表单ID",type:"String"}],open:!0,handlerFuncName:"open",handlerCode:"async open (id) {\n  // 获取详情数据\n  const res = await dibootApi.get(`${this.baseApi}/${id}`)\n  if (res.code === 0) {\n    this.model = res.data\n    this.attachMore()\n    this.afterOpen()\n  } else {\n    this.$message.error(res.msg)\n  }\n}"},{key:"enhance",name:"数据处理",params:[],open:!0,handlerFuncName:"enhance",handlerCode:"enhance (values) {\n  return _.assign(this.model, values)\n}"},{key:"submit",name:"提交表单",params:[],open:!0,handlerFuncName:"onSubmit",handlerCode:"async submit () {\n  this.state.confirmSubmit = true\n  let values = await this.validate()\n  values = this.enhance(values)\n  try {\n    const res = await dibootApi.put(`${this.baseApi}/${this.id}`, values)\n    if (res.code === 0) {\n      this.submitSuccess(res)\n      this.open(this.id)\n    } else {\n      this.submitFailed(res)\n    }\n  } catch (e) {\n    // 执行一系列后续操作\n    this.submitFailed(e)\n  }\n}"}],batchUpdateRecord:[{key:"open",name:"打开表单",params:[],open:!0,handlerFuncName:"open",handlerCode:"open () {\n  this.attachMore()\n}"},{key:"submit",name:"提交表单",params:[],open:!0,handlerFuncName:"onSubmit",handlerCode:"async submit () {\n  this.state.confirmSubmit = true\n  const values = await this.validate()\n  try {\n    const res = await dibootApi.post(`${this.baseApi}/batchUpdate`, {\n      data: values,\n      idList: this.idList\n    })\n    if (res.code === 0) {\n      this.submitSuccess(res)\n    } else {\n      this.submitFailed(res)\n    }\n  } catch (e) {\n    // 执行一系列后续操作\n    this.submitFailed(e)\n  }\n}"}],createRecord:[{key:"open",name:"打开表单",params:[],open:!0,handlerFuncName:"open",handlerCode:"open () {\n  this.attachMore()\n}"},{key:"submit",name:"提交表单",params:[],open:!0,handlerFuncName:"onSubmit",handlerCode:"async submit () {\n  this.state.confirmSubmit = true\n  const values = await this.validate()\n  this.enhance(values)\n  try {\n    const res = await dibootApi.post(`${this.baseApi}/`, values)\n    if (res.code === 0) {\n      this.submitSuccess(res)\n    } else {\n      this.submitFailed(res)\n    }\n  } catch (e) {\n    // 执行一系列后续操作\n    this.submitFailed(e)\n  }\n}"}]},a=[{key:"submitSuccess",name:"提交成功",params:[],open:!0,handlerFuncName:"submitSuccess",handlerCode:"submitSuccess (result) {\n  this.$notification.success({\n    message: '操作成功',\n    description: result.msg\n  })\n  this.close()\n  this.form.resetFields()\n  this.$emit('complete')\n}"}],o=n[e];void 0===o&&(o=[]),(t=o).push.apply(t,a);var i=this.moduleConfig.metadata.tableObj.className,r=this.moduleConfig.metadata.tableObj.instClassName;o.forEach(function(e){e.handlerCode=e.handlerCode.replace(/__className__/g,i).replace(/__instClassName__/g,r)}),this.moduleConfig.scriptConfig.event=o;var l={updateRecord:{key:"id",name:"表单ID",type:"String",default:"",required:!0,hasWatch:!0,immediate:!0,watchCode:"function(val) {\n  // 数据更改处理流程\n  this.open(val)\n}"},batchUpdateRecord:{key:"idList",name:"ID列表",type:"Array",default:"",required:!1,hasWatch:!1,immediate:!1,watchCode:"function(val) {\n  // 数据更改处理流程\n}"}},c=l[e];void 0!==c&&u["a"].$emit("addGlobalProp",c);var s=d["a"][e];void 0!==s&&u["a"].$emit("removeGlobalProp",s)},startConfigValidate:function(e){var t=this;this.$refs.configForm.validate(function(n,a){if(n)e();else{var o=t.collectErrMsg(a);e(o)}})},listTableNameChanged:function(e,t){var n=this.listTables.find(function(t){return t.tableName===e});this.moduleConfig.metadata.tableObj=n,this.getListColumns(e,t),this.switchFormType(this.moduleConfig.metadata.formType)},getListColumns:function(e,t){var n=this;this.listColumns=[],s["a"].get("/diboot/devtools/db/cols/".concat(e)).then(function(e){if(0===e.code){n.listColumns=e.data;var a=n.moduleConfig.metadata.columns;t&&a.length>0?n.$nextTick(function(){var e=n.$refs.columnListSelector;e&&e.setResultColumns(a)}):n.moduleConfig.metadata.columns=[]}})},expandColumnsFilter:function(e){return!0},validListColumnsFilter:function(e){return"id"!==e.fieldName&&"uuid"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&"createTime"!==e.fieldName&&"updateTime"!==e.fieldName&&"createBy"!==e.fieldName&&"updateBy"!==e.fieldName},autoSetterColFilter:function(e){return"tenantId"!==e.fieldName}},computed:{formTypeKeys:function(){return Object.keys(this.formTypeCons)},btnWindowDataList:function(){return this.moduleConfig.metadata.columns&&0!==this.moduleConfig.metadata.columns.length?this.moduleConfig.metadata.columns.filter(function(e){return"btnPopWindow"===e.actionType}).map(function(e){return e.btnWindowData}):[]}},mixins:[r["a"],c["a"]],components:{columnListSelectorPlus:l["a"],btnPopWindowPanelSelector:f["a"]},mounted:function(){this.$nextTick(function(){var e=this;s["a"].get("/diboot/devtools/db/edttbls").then(function(t){if(0===t.code&&(e.listTables=t.data.filter(function(e){return e.editable}),e.listTables.length>0)){var n=e.listTables[0].tableName;try{e.moduleConfig.metadata.tableName?n=e.moduleConfig.metadata.tableName:e.moduleConfig.metadata.tableName=n}catch(a){console.log("通用列表获取当前表名出错",n)}e.listTableNameChanged(n,!0)}})})}},y=v,C=(n("119f"),n("2877")),w=Object(C["a"])(y,a,o,!1,null,"090fe395",null);t["default"]=w.exports},8656:function(e,t,n){"use strict";var a=n("75fc"),o=(n("ac6a"),n("cebc")),i=(n("6762"),n("2fdb"),n("2f62"));t["a"]={methods:{hasPermission:function(e){return 0===this.actionList.length||this.actionList.includes(e)}},computed:Object(o["a"])({},Object(i["f"])({mainLevel:function(e){return e.user.mainLevel}}),{actionList:function(){if(!this.mainLevel||!this.mainLevel.permissions||0===this.mainLevel.permissions.length)return[];var e=[];return this.mainLevel.permissions.forEach(function(t){t.actionList&&t.actionList.length>0&&e.push.apply(e,Object(a["a"])(t.actionList))}),e}})}},"8a81":function(e,t,n){"use strict";var a=n("7726"),o=n("69a8"),i=n("9e1e"),r=n("5ca1"),l=n("2aba"),c=n("67ab").KEY,s=n("79e5"),u=n("5537"),d=n("7f20"),f=n("ca5a"),m=n("2b4c"),p=n("37c8"),h=n("3a72"),g=n("d4c0"),b=n("1169"),v=n("cb7c"),y=n("d3f4"),C=n("4bf8"),w=n("6821"),k=n("6a99"),_=n("4630"),x=n("2aeb"),S=n("7bbc"),T=n("11e9"),N=n("2621"),O=n("86cc"),j=n("0d58"),F=T.f,L=O.f,D=S.f,M=a.Symbol,E=a.JSON,I=E&&E.stringify,P="prototype",$=m("_hidden"),R=m("toPrimitive"),A={}.propertyIsEnumerable,W=u("symbol-registry"),q=u("symbols"),U=u("op-symbols"),z=Object[P],B="function"==typeof M&&!!N.f,V=a.QObject,G=!V||!V[P]||!V[P].findChild,K=i&&s(function(){return 7!=x(L({},"a",{get:function(){return L(this,"a",{value:7}).a}})).a})?function(e,t,n){var a=F(z,t);a&&delete z[t],L(e,t,n),a&&e!==z&&L(z,t,a)}:L,H=function(e){var t=q[e]=x(M[P]);return t._k=e,t},Y=B&&"symbol"==typeof M.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof M},J=function(e,t,n){return e===z&&J(U,t,n),v(e),t=k(t,!0),v(n),o(q,t)?(n.enumerable?(o(e,$)&&e[$][t]&&(e[$][t]=!1),n=x(n,{enumerable:_(0,!1)})):(o(e,$)||L(e,$,_(1,{})),e[$][t]=!0),K(e,t,n)):L(e,t,n)},Q=function(e,t){v(e);var n,a=g(t=w(t)),o=0,i=a.length;while(i>o)J(e,n=a[o++],t[n]);return e},X=function(e,t){return void 0===t?x(e):Q(x(e),t)},Z=function(e){var t=A.call(this,e=k(e,!0));return!(this===z&&o(q,e)&&!o(U,e))&&(!(t||!o(this,e)||!o(q,e)||o(this,$)&&this[$][e])||t)},ee=function(e,t){if(e=w(e),t=k(t,!0),e!==z||!o(q,t)||o(U,t)){var n=F(e,t);return!n||!o(q,t)||o(e,$)&&e[$][t]||(n.enumerable=!0),n}},te=function(e){var t,n=D(w(e)),a=[],i=0;while(n.length>i)o(q,t=n[i++])||t==$||t==c||a.push(t);return a},ne=function(e){var t,n=e===z,a=D(n?U:w(e)),i=[],r=0;while(a.length>r)!o(q,t=a[r++])||n&&!o(z,t)||i.push(q[t]);return i};B||(M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===z&&t.call(U,n),o(this,$)&&o(this[$],e)&&(this[$][e]=!1),K(this,e,_(1,n))};return i&&G&&K(z,e,{configurable:!0,set:t}),H(e)},l(M[P],"toString",function(){return this._k}),T.f=ee,O.f=J,n("9093").f=S.f=te,n("52a7").f=Z,N.f=ne,i&&!n("2d00")&&l(z,"propertyIsEnumerable",Z,!0),p.f=function(e){return H(m(e))}),r(r.G+r.W+r.F*!B,{Symbol:M});for(var ae="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),oe=0;ae.length>oe;)m(ae[oe++]);for(var ie=j(m.store),re=0;ie.length>re;)h(ie[re++]);r(r.S+r.F*!B,"Symbol",{for:function(e){return o(W,e+="")?W[e]:W[e]=M(e)},keyFor:function(e){if(!Y(e))throw TypeError(e+" is not a symbol!");for(var t in W)if(W[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),r(r.S+r.F*!B,"Object",{create:X,defineProperty:J,defineProperties:Q,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:ne});var le=s(function(){N.f(1)});r(r.S+r.F*le,"Object",{getOwnPropertySymbols:function(e){return N.f(C(e))}}),E&&r(r.S+r.F*(!B||s(function(){var e=M();return"[null]"!=I([e])||"{}"!=I({a:e})||"{}"!=I(Object(e))})),"JSON",{stringify:function(e){var t,n,a=[e],o=1;while(arguments.length>o)a.push(arguments[o++]);if(n=t=a[1],(y(t)||void 0!==e)&&!Y(e))return b(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Y(t))return t}),a[1]=t,I.apply(E,a)}}),M[P][R]||n("32e9")(M[P],R,M[P].valueOf),d(M,"Symbol"),d(Math,"Math",!0),d(a.JSON,"JSON",!0)},9375:function(e,t,n){},a979:function(e,t,n){"use strict";var a=n("cebc"),o=n("2ef0"),i=n.n(o),r=n("2f62"),l=n("1ca6"),c=n("80da"),s=Object(r["a"])("DragMobileConfig"),u=s.mapMutations;t["a"]={data:function(){return{workspace:"DragMobileConfig"}},methods:Object(a["a"])({},u(["updateModuleConfigList","updateConfigMap"])),computed:{moduleConfig:{get:function(){var e=this.$store.state.DragMobileConfig[this.code].moduleConfigMap;return e[this.uuid]},set:function(e){var t=this.$store.state.DragMobileConfig[this.code].moduleConfigMap;t[this.uuid];i.a.cloneDeep(e),this.updateConfigMap({key:this.code,configMap:t})}}},components:{eventKit:l["a"]},mixins:[c["a"]],props:{uuid:{type:String,required:!0},code:{type:String,required:!0},projectType:{type:String,required:!0}}}},ac4d:function(e,t,n){n("3a72")("asyncIterator")},b023:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"a",function(){return g});var a="entity_without_sys",o="entity_tree",i="entity_has_ref",r="entity_has_ref_tree",l="entity_has_ref_dict",c="entity_has_ref_table",s="field_without_sys",u="field_entity_tree",d="field_entity_has_ref",f="field_entity_has_ref_tree",m="field_entity_has_ref_dict",p="field_entity_has_ref_table",h={entity_without_sys:a,entity_tree:o,entity_has_ref:i,entity_has_ref_tree:r,entity_has_ref_dict:l,entity_has_ref_table:c,field_without_sys:s,field_entity_tree:u,field_entity_has_ref:d,field_entity_has_ref_tree:f,field_entity_has_ref_dict:m,field_entity_has_ref_table:p},g={primaryKey:"primaryKey",createTime:"createTime",showField:"showField",filter:"filter"}},b97a:function(e,t,n){},c40b:function(e,t,n){"use strict";var a=n("231b"),o=n.n(a);o.a},c5e9:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form-model",[n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"名称"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"按钮名称"},model:{value:e.config.name,callback:function(t){e.$set(e.config,"name",t)},expression:"config.name"}})],1),n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"类型"}},["element"===e.projectType?[n("a-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.config.btnType,callback:function(t){e.$set(e.config,"btnType",t)},expression:"config.btnType"}},[n("a-select-option",{attrs:{value:"primary"}},[e._v("\n          主按钮\n        ")]),n("a-select-option",{attrs:{value:"success"}},[e._v("\n          成功按钮\n        ")]),n("a-select-option",{attrs:{value:"info"}},[e._v("\n          信息按钮\n        ")]),n("a-select-option",{attrs:{value:"warning"}},[e._v("\n          警告按钮\n        ")]),n("a-select-option",{attrs:{value:"danger"}},[e._v("\n          危险按钮\n        ")]),n("a-select-option",{attrs:{value:"link"}},[e._v("\n          链接按钮\n        ")])],1)]:[n("a-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.config.btnType,callback:function(t){e.$set(e.config,"btnType",t)},expression:"config.btnType"}},[n("a-select-option",{attrs:{value:"primary"}},[e._v("\n          主按钮类型\n        ")]),n("a-select-option",{attrs:{value:"default"}},[e._v("\n          默认类型\n        ")]),n("a-select-option",{attrs:{value:"link"}},[e._v("\n          链接按钮\n        ")])],1)]],2),n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"图标"}},[n("a-popover",{attrs:{title:"按钮图标选择",placement:"topRight",trigger:"click"}},[n("template",{slot:"content"},[n("icon-selector",{attrs:{"project-type":e.projectType},model:{value:e.config.btnIcon,callback:function(t){e.$set(e.config,"btnIcon",t)},expression:"config.btnIcon"}})],1),n("a-button",{attrs:{type:"link"}},[e._v("\n        设置\n      ")])],2)],1),n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"触发"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.config.trigger,callback:function(t){e.$set(e.config,"trigger",t)},expression:"config.trigger"}},[n("a-select-option",{attrs:{value:"click"}},[e._v("\n        点击触发\n      ")])],1)],1),n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"事件"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.config.event,callback:function(t){e.$set(e.config,"event",t)},expression:"config.event"}},[n("a-select-option",{attrs:{value:"click"}},[e._v("\n        执行自定义函数\n      ")]),n("a-select-option",{attrs:{value:"popWindow"}},[e._v("\n        弹出窗口\n      ")])],1)],1),"click"===e.config.event?n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"函数"}},[n("a-popover",{attrs:{placement:"left",title:"@click 按钮点击事件函数",trigger:"click"}},[n("div",{staticStyle:{width:"600px",height:"400px"},attrs:{slot:"content"},slot:"content"},[n("smart-code-editor",{attrs:{code:e.code,workspace:e.workspace},on:{input:function(t){return e.onHandlerCodeChange(t,e.config.clickEvent)}},model:{value:e.config.clickEvent.handlerCode,callback:function(t){e.$set(e.config.clickEvent,"handlerCode",t)},expression:"config.clickEvent.handlerCode"}})],1),n("a-button",{staticStyle:{margin:"10px 0"},attrs:{block:"",type:"primary",size:"small"}},[e._v("\n        编辑自定义函数\n      ")])],1)],1):e._e(),"popWindow"===e.config.event?n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"类型"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.config.windowType,callback:function(t){e.$set(e.config,"windowType",t)},expression:"config.windowType"}},[n("a-select-option",{attrs:{value:"modal"}},[e._v("\n        模态框\n      ")])],1)],1):e._e(),"popWindow"===e.config.event?n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"标题"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"弹窗标题"},model:{value:e.config.windowTitle,callback:function(t){e.$set(e.config,"windowTitle",t)},expression:"config.windowTitle"}})],1):e._e(),"popWindow"===e.config.event?n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"宽度"}},[n("a-slider",{attrs:{defaultValue:1200,min:300,max:2e3,step:10},model:{value:e.config.windowWidth,callback:function(t){e.$set(e.config,"windowWidth",t)},expression:"config.windowWidth"}})],1):e._e(),"popWindow"===e.config.event?n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:8},wrapperCol:{span:16},label:"确认事件"}},[n("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"未启用"},model:{value:e.config.confirmEvent.open,callback:function(t){e.$set(e.config.confirmEvent,"open",t)},expression:"config.confirmEvent.open"}})],1):e._e(),"popWindow"===e.config.event&&e.config.confirmEvent.open?n("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"函数"}},[n("a-popover",{attrs:{placement:"left",title:"@confirm 弹框确认事件函数",trigger:"click"}},[n("div",{staticStyle:{width:"600px",height:"400px"},attrs:{slot:"content"},slot:"content"},[n("smart-code-editor",{attrs:{code:e.code,workspace:e.workspace,"extra-method-obj-list":e.extraMethodObjList},on:{input:function(t){return e.onHandlerCodeChange(t,e.config.confirmEvent)}},model:{value:e.config.confirmEvent.handlerCode,callback:function(t){e.$set(e.config.confirmEvent,"handlerCode",t)},expression:"config.confirmEvent.handlerCode"}})],1),n("a-button",{staticStyle:{margin:"10px 0"},attrs:{block:"",type:"primary",size:"small"}},[e._v("\n        编辑自定义函数\n      ")])],1)],1):e._e(),void 0!==e.panelConfig&&"popWindow"===e.config.event?n("general-panel-config",{attrs:{"panel-list":e.panelList,"extract-panel-extra-methods":e.extractAllBtnWindowMethods,"append-extra-panel-config":e.appendExtraPanelConfig,code:e.code,workspace:e.workspace},on:{change:e.onPanelChanged,updatePanelList:function(t){return e.$emit("updatePanelList",t)}},model:{value:e.panelConfig,callback:function(t){e.panelConfig=t},expression:"panelConfig"}}):e._e()],1)},o=[],i=(n("7f7f"),n("541c")),r={name:"自定义",btnType:"primary",btnIcon:"",trigger:"click",event:"popWindow",windowType:"modal",windowTitle:"",windowWidth:1200,windowRefName:"",panelRefName:"",clickEvent:{key:"click",name:"选择当前节点",params:[],open:!0,handlerFuncName:"onButtonClick",handlerCode:"onButtonClick() {\n  // 确认按钮点击事件处理代码（方法名不能重复）\n}"},confirmEvent:{key:"confirm",name:"选择当前节点",params:[],open:!1,handlerFuncName:"onConfirm",handlerCode:"onConfirm() {\n  // 确认弹窗事件处理代码\n}"},panelConfig:{}},l=n("2ef0"),c=n.n(l),s=n("085b"),u=n("1ca6"),d=n("788b"),f=n("d099"),m=n("218b"),p={name:"BtnPopWindowPanelSelector",data:function(){return{panelConfig:void 0,extraMethodObjList:[]}},methods:{onHandlerCodeChange:function(e,t){t.handlerFuncName=Object(i["a"])(e)},onPanelChanged:function(e){this.config.panelConfig=c.a.cloneDeep(e),this.$emit("change",this.config)},appendExtraPanelConfig:function(e){e.refName?e.windowRefName="".concat(e.refName,"Window"):e.windowRefName=""},initConfig:function(e){if(!(e&&e.panelConfig&&e.panelConfig.refName))return this.panelConfig={},!1;this.panelConfig=c.a.cloneDeep(e.panelConfig)}},components:{propsKit:s["a"],eventKit:u["a"],smartCodeEditor:d["a"],iconSelector:f["a"],generalPanelConfig:m["a"]},mounted:function(){this.$nextTick(function(){void 0!==this.config&&this.config.name?this.initConfig(this.config):(this.$emit("change",c.a.cloneDeep(r)),this.panelConfig=c.a.cloneDeep(r.panelConfig))})},model:{prop:"config",event:"change"},props:{config:{type:Object,default:function(){return c.a.cloneDeep(r)}},workspace:{type:String,default:"panelDesigner"},code:{type:String,default:""},projectType:{type:String,required:!0},btnWindowDataList:{type:Array,default:function(){return[]}},panelList:{type:Array,default:void 0},extractAllBtnWindowMethods:{type:Function,required:!0}}},h=p,g=n("2877"),b=Object(g["a"])(h,a,o,!1,null,null,null);t["a"]=b.exports},ce8f:function(e,t,n){},d099:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form",{attrs:{layout:"vertical"}},[n("a-form-item",[n("a-input",{attrs:{placeholder:"输入或点击下方图标选择"},model:{value:e.inputIcon,callback:function(t){e.inputIcon=t},expression:"inputIcon"}})],1),n("a-form-item",[n("a-row",{staticStyle:{"max-height":"240px",width:"420px","overflow-y":"scroll"}},["antdv"===e.projectType?e._l(e.iconsMap["antdv"],function(t){return n("a-col",{key:t,staticClass:"icon-col",class:{current:e.currentIcon===t},attrs:{span:2},on:{click:function(n){return e.changeIcon(t)}}},[n("a-icon",{attrs:{type:t}})],1)}):e._e(),"element"===e.projectType?e._l(e.iconsMap["element"],function(t){return n("a-col",{key:t,staticClass:"icon-col icon-element",class:{current:e.currentIcon===t},attrs:{span:2},on:{click:function(n){return e.changeIcon(t)}}},[n("i",{class:t})])}):e._e()],2)],1)],1)},o=[],i={antdv:["account-book","alert","api","appstore","audio","bank","bell","book","bug","bulb","calculator","build","calendar","camera","car","carry-out","cloud","code","compass","contacts","container","control","credit-card","crown","customer-service","dashboard","database","dislike","environment","experiment","eye-invisible","eye","file-add","file-excel","file-exclamation","file-image","file-markdown","file-pdf","file-ppt","file-text","file-unknown","file-word","file-zip","file","filter","fire","flag","folder-add","folder","folder-open","frown","funnel-plot","gift","hdd","heart","home","hourglass","idcard","insurance","interaction","layout","like","lock","mail","medicine-box","meh","message","mobile","money-collect","pay-circle","notification","phone","picture","play-square","printer","profile","project","pushpin","property-safety","read","reconciliation","red-envelope","rest","rocket","safety-certificate","save","schedule","security-scan","setting","shop","shopping","skin","smile","sound","star","switcher","tablet","tag","tags","tool","thunderbolt","trophy","unlock","usb","video-camera","wallet","apartment","audit","barcode","bars","block","border","branches","ci","cloud-download","cloud-server","cloud-sync","cloud-upload","cluster","coffee","copyright","deployment-unit","desktop","disconnect","dollar","download","ellipsis","euro","exception","export","file-done","file-jpg","file-protect","file-sync","file-search","fork","gateway","global","gold","history","import","inbox","key","laptop","link","line","loading-3-quarters","loading","man","menu","monitor","more","number","percentage","paper-clip","pound","poweroff","pull-request","qrcode","reload","safety","robot","scan","search","select","shake","share-alt","shopping-cart","solution","sync","table","team","to-top","trademark","transaction","upload","user-add","user-delete","usergroup-add","user","usergroup-delete","wifi","woman"],element:["el-icon-platform-eleme","el-icon-eleme","el-icon-delete-solid","el-icon-delete","el-icon-s-tools","el-icon-setting","el-icon-user-solid","el-icon-user","el-icon-phone","el-icon-phone-outline","el-icon-more","el-icon-more-outline","el-icon-star-on","el-icon-star-off","el-icon-s-goods","el-icon-goods","el-icon-warning","el-icon-warning-outline","el-icon-question","el-icon-info","el-icon-remove","el-icon-circle-plus","el-icon-success","el-icon-error","el-icon-zoom-in","el-icon-zoom-out","el-icon-remove-outline","el-icon-circle-plus-outline","el-icon-circle-check","el-icon-circle-close","el-icon-s-help","el-icon-help","el-icon-minus","el-icon-plus","el-icon-check","el-icon-close","el-icon-picture","el-icon-picture-outline","el-icon-picture-outline-round","el-icon-upload","el-icon-upload2","el-icon-download","el-icon-camera-solid","el-icon-camera","el-icon-video-camera-solid","el-icon-video-camera","el-icon-message-solid","el-icon-bell","el-icon-s-cooperation","el-icon-s-order","el-icon-s-platform","el-icon-s-fold","el-icon-s-unfold","el-icon-s-operation","el-icon-s-promotion","el-icon-s-home","el-icon-s-release","el-icon-s-ticket","el-icon-s-management","el-icon-s-open","el-icon-s-shop","el-icon-s-marketing","el-icon-s-flag","el-icon-s-comment","el-icon-s-finance","el-icon-s-claim","el-icon-s-custom","el-icon-s-opportunity","el-icon-s-data","el-icon-s-check","el-icon-s-grid","el-icon-menu","el-icon-share","el-icon-d-caret","el-icon-caret-left","el-icon-caret-right","el-icon-caret-bottom","el-icon-caret-top","el-icon-bottom-left","el-icon-bottom-right","el-icon-back","el-icon-right","el-icon-bottom","el-icon-top","el-icon-top-left","el-icon-top-right","el-icon-arrow-left","el-icon-arrow-right","el-icon-arrow-down","el-icon-arrow-up","el-icon-d-arrow-left","el-icon-d-arrow-right","el-icon-video-pause","el-icon-video-play","el-icon-refresh","el-icon-refresh-right","el-icon-refresh-left","el-icon-finished","el-icon-sort","el-icon-sort-up","el-icon-sort-down","el-icon-rank","el-icon-loading","el-icon-view","el-icon-c-scale-to-original","el-icon-date","el-icon-edit","el-icon-edit-outline","el-icon-folder","el-icon-folder-opened","el-icon-folder-add","el-icon-folder-remove","el-icon-folder-delete","el-icon-folder-checked","el-icon-tickets","el-icon-document-remove","el-icon-document-delete","el-icon-document-copy","el-icon-document-checked","el-icon-document","el-icon-document-add","el-icon-printer","el-icon-paperclip","el-icon-takeaway-box","el-icon-search","el-icon-monitor","el-icon-attract","el-icon-mobile","el-icon-scissors","el-icon-umbrella","el-icon-headset","el-icon-brush","el-icon-mouse","el-icon-coordinate","el-icon-magic-stick","el-icon-reading","el-icon-data-line","el-icon-data-board","el-icon-pie-chart","el-icon-data-analysis","el-icon-collection-tag","el-icon-film","el-icon-suitcase","el-icon-suitcase-1","el-icon-receiving","el-icon-collection","el-icon-files","el-icon-notebook-1","el-icon-notebook-2","el-icon-toilet-paper","el-icon-office-building","el-icon-school","el-icon-table-lamp","el-icon-house","el-icon-no-smoking","el-icon-smoking","el-icon-shopping-cart-full","el-icon-shopping-cart-1","el-icon-shopping-cart-2","el-icon-shopping-bag-1","el-icon-shopping-bag-2","el-icon-sold-out","el-icon-sell","el-icon-present","el-icon-box","el-icon-bank-card","el-icon-money","el-icon-coin","el-icon-wallet","el-icon-discount","el-icon-price-tag","el-icon-news","el-icon-guide","el-icon-male","el-icon-female","el-icon-thumb","el-icon-cpu","el-icon-link","el-icon-connection","el-icon-open","el-icon-turn-off","el-icon-set-up","el-icon-chat-round","el-icon-chat-line-round","el-icon-chat-square","el-icon-chat-dot-round","el-icon-chat-dot-square","el-icon-chat-line-square","el-icon-message","el-icon-postcard","el-icon-position","el-icon-turn-off-microphone","el-icon-microphone","el-icon-close-notification","el-icon-bangzhu","el-icon-time","el-icon-odometer","el-icon-crop","el-icon-aim","el-icon-switch-button","el-icon-full-screen","el-icon-copy-document","el-icon-mic","el-icon-stopwatch","el-icon-medal-1","el-icon-medal","el-icon-trophy","el-icon-trophy-1","el-icon-first-aid-kit","el-icon-discover","el-icon-place","el-icon-location","el-icon-location-outline","el-icon-location-information","el-icon-add-location","el-icon-delete-location","el-icon-map-location","el-icon-alarm-clock","el-icon-timer","el-icon-watch-1","el-icon-watch","el-icon-lock","el-icon-unlock","el-icon-key","el-icon-service","el-icon-mobile-phone","el-icon-bicycle","el-icon-truck","el-icon-ship","el-icon-basketball","el-icon-football","el-icon-soccer","el-icon-baseball","el-icon-wind-power","el-icon-light-rain","el-icon-lightning","el-icon-heavy-rain","el-icon-sunrise","el-icon-sunrise-1","el-icon-sunset","el-icon-sunny","el-icon-cloudy","el-icon-partly-cloudy","el-icon-cloudy-and-sunny","el-icon-moon","el-icon-moon-night","el-icon-dish","el-icon-dish-1","el-icon-food","el-icon-chicken","el-icon-fork-spoon","el-icon-knife-fork","el-icon-burger","el-icon-tableware","el-icon-sugar","el-icon-dessert","el-icon-ice-cream","el-icon-hot-water","el-icon-water-cup","el-icon-coffee-cup","el-icon-cold-drink","el-icon-goblet","el-icon-goblet-full","el-icon-goblet-square","el-icon-goblet-square-full","el-icon-refrigerator","el-icon-grape","el-icon-watermelon","el-icon-cherry","el-icon-apple","el-icon-pear","el-icon-orange","el-icon-coffee","el-icon-ice-tea","el-icon-ice-drink","el-icon-milk-tea","el-icon-potato-strips","el-icon-lollipop","el-icon-ice-cream-square","el-icon-ice-cream-round"]},r={name:"IconSelector",data:function(){return{iconsMap:i,inputIcon:""}},methods:{changeIcon:function(e){this.inputIcon=e,this.$emit("change",e)}},watch:{inputIcon:function(e){e!==this.currentIcon&&this.$emit("change",e)}},model:{prop:"currentIcon",event:"change"},props:{currentIcon:{type:String,default:""},projectType:{type:String,default:""}},created:function(){this.inputIcon=this.currentIcon}},l=r,c=(n("58de"),n("2877")),s=Object(c["a"])(l,a,o,!1,null,"443add4a",null);t["a"]=s.exports},d4c0:function(e,t,n){var a=n("0d58"),o=n("2621"),i=n("52a7");e.exports=function(e){var t=a(e),n=o.f;if(n){var r,l=n(e),c=i.f,s=0;while(l.length>s)c.call(e,r=l[s++])&&t.push(r)}return t}},e6f0:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return void 0!==e.solutionObj.key?n("div",{staticClass:"abstractPanelConfig"},[e.solutionObj.tips?n("a-alert",{attrs:{message:"代码调整提示",banner:""}},[n("template",{slot:"description"},[n("div",[e._v(e._s(e.solutionObj.tips))]),e.solutionObj.tipUrl?n("a",{attrs:{href:e.solutionObj.tipUrl,target:"_blank"}},[e._v("调整参考步骤")]):e._e()])],2):e._e(),n("br"),void 0!==e.modelMap?[e._l(e.abstractStrategys,function(t,a){return["dynamic_table_fields"===t.type?n("table-and-columns-cascade-selector",{key:a,attrs:{"module-config":e.moduleConfig,"model-map":e.modelMap,"solution-obj":e.solutionObj,strategy:t,"props-setter":e.propsSetter,"new-solution":e.isNewSolution,"project-type":e.projectType}}):"dynamic_table_line_width_config"===t.type?n("dynamic-table-display-config",{key:a,attrs:{"module-config":e.moduleConfig,"model-map":e.modelMap,"solution-obj":e.solutionObj,strategy:t,"props-setter":e.propsSetter,"new-solution":e.isNewSolution}}):e._e()]})]:e._e()],2):e._e()},o=[],i=(n("a481"),n("7f7f"),n("7514"),n("ac4d"),n("8a81"),n("ac6a"),n("96cf"),n("3b8d")),r=n("cebc"),l=n("e5b5"),c=n("3aa3"),s=[{name:"removeAllModules",func:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()}],u=s,d=n("2ef0"),f=n.n(d),m=[{label:"获取关联的子实体",name:"getRelationChildren",func:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.relationInfo,a=n.refChildren,a&&0!==a.length){e.next=4;break}return e.abrupt("return",void 0);case 4:return console.log("relationInfo",f.a.cloneDeep(n)),e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{label:"获取实体的字段列表",name:"setTableColumns",func:function(e){},showSelector:!0},{label:"获取关联树结构实体",name:"getTreeRefs",func:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.relationInfo,a=n.treeRefs,a&&0!==a.length){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}],p=m,h=n("3e9c"),g=n("2f62"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form-model",{ref:"form",attrs:{layout:"horizontal",rules:e.rules,"label-col":{span:6},"wrapper-col":{span:18},model:this}},[n("a-form-model-item",{attrs:{label:"实体选择"}},[e.tables.length>0?[n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":e.filterOption,value:e.listTableName},on:{change:function(t){return e.tableNameChanged(t)}}},e._l(e.tables,function(t,a){return n("a-select-option",{key:a,attrs:{value:t.tableName}},[e._v("\n            "+e._s(t.objName)+" ["+e._s(t.tableName)+"]\n          ")])}),1)]:n("span",[e._v("\n        暂无实体可选\n      ")])],2),e._l(e.columnStrategys,function(t,a){return[e.columns.length>0&&(!t.showStateField||e.configMap[e.strategy.uuid]["metadata"][t.showStateField])?n("column-list-selector-plus",{key:a,ref:"columnsSelector_"+a,refInFor:!0,attrs:{"valid-columns-filter":function(n){return e.validColumnFilter(n,e.solutionObj.columnsConfig[t.name].filter)},"is-expand":e.solutionObj.columnsConfig[t.name].isExpand,"init-columns":e.columns,"need-ref-entity":!1,"vo-type":e.solutionObj.columnsConfig[t.name].voType,title:t.label},on:{change:function(n){return e.columnsChanged(n,t)}}}):e._e()]})],2)],1)},v=[],y=n("4047"),C=n("77db"),w=n("5f70"),k=n("6892"),_=n("b023"),x=Object(g["a"])("database"),S=x.mapState,T=Object(g["a"])("DragConfig"),N=T.mapState,O=Object(g["a"])("panelDesigner"),j=O.mapState,F=O.mapMutations,L={name:"TableAndColumnsCascadeSelector",data:function(){return{rules:{currentTableName:[{required:!0,message:"请选择列表实体",trigger:"blur"}]},currentTableName:"",tables:[],columns:[],formPanelUuid:""}},methods:Object(r["a"])({},F(["setModuleConfig"]),{columnsChanged:function(e,t){this.setData2config(f.a.cloneDeep(e),t.strategy.target);var n=this.strategy.moduleName;if("multiForm"===n){var a=Object(w["a"])(e);this.setData2config(JSON.stringify(a),"fieldsObjStr")}},validColumnFilter:function(e,t){if(void 0===t)return!0;if("boolean"===typeof t)return t;if("function"===typeof t){var n=this.pageTableName,a={pageTableName:n};return t(e,a)}},setData2config:function(e,t){var n=this.configMap,a=this.strategy,o=a.uuid,i=n[o];if(void 0!==i&&void 0!==i.metadata){var r=i.metadata;r[t]=e,this.setModuleConfig({key:"preview",uuid:o,config:i})}},tableNameChanged:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var a,o,i,r,l,c,s,u,d,f,m,p,h,g,b,v,y,w,k,_,x,S=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.tables.find(function(e){return e.tableName===t}),n=n||0,a||!(n<10)){e.next=6;break}return console.log("重试中..."),setTimeout(function(){n++,S.tableNameChanged(t,n)},1e3),e.abrupt("return",!1);case 6:if(a){e.next=8;break}return e.abrupt("return",!1);case 8:return o=this.strategy,i=this.solutionObj,r=this.moduleConfig,l=o.strategy,c=l.target,s=l.tableInfoTarget,this.setData2config(t,c),this.setData2config(a,s),u=i.nameTmpl,d=i.codeTmpl,f=i.containerConfigAutoSetter,m=a.objName,p=a.instClassName,h=u.replace("{objName}",m),g=d.replace("{instClassName}",p),this.moduleConfig.metadata.panelConfig.refName=g,this.moduleConfig.metadata.panelConfig.panelInfo.name=h,this.moduleConfig.metadata.panelConfig.panelInfo.code=g,this.moduleConfig.metadata.panelConfig.panelInfo.fileName=g,this.moduleConfig.metadata.panelConfig.panelInfo.componentName=Object(C["a"])(g),e.next=23,this.loadColumns(t);case 23:this.propsSetter&&(b=this.columns,v=r.scriptConfig.props,this.propsSetter(v,{columns:b})),f&&"function"===typeof f&&(y=this.pageTableName,w=this.pageColumns,k=this.columns,_=this.projectType,x={pageTableName:y,pageColumns:w,tableName:t,columns:k,projectType:_},f(r,x));case 25:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),loadTables:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,a,o,i,r,l,c,s,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.solutionObj,n=this.modelMap,a=t.valueGetterFunc,void 0!==a){e.next=4;break}return e.abrupt("return",[]);case 4:if(o=a.entity_without_sys,i=o.origin,r=o.getDefaultValue,l=o.getOptions,void 0!==i&&void 0!==r&&void 0!==l){e.next=7;break}return e.abrupt("return",[]);case 7:if(c=n[i],void 0!==c){e.next=10;break}return e.abrupt("return",[]);case 10:if(s=l(c),this.tables=s,!this.newSolution){e.next=16;break}return u=r(c),e.next=16,this.tableNameChanged(u);case 16:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),loadColumns:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.columns=[],e.next=3,c["a"].get("/diboot/devtools/db/cols/".concat(t));case 3:n=e.sent,0===n.code&&(n.data.forEach(function(e){e.columnExt||(e.columnExt={})}),this.columns=n.data,this.afterLoadColumns());case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),afterLoadColumns:function(){var e=this.columns,t=this.fieldStrategys;if(!e||0===e.length||0===t.length)return!1;var n=!0,a=!1,o=void 0;try{for(var i,r=t[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value,c=l.strategy,s=c.type,u=c.target,d="";if(s===_["a"].showField&&"treeShowFieldName"===u&&function(){var t=e.find(function(e){return e.columnExt&&e.columnExt.refTable===e.tableName});if(void 0!==t){var n=e.find(function(e){return e.colName===t.columnExt.asColumn});void 0!==n&&(d=n.fieldName)}}(),s===_["a"].showField&&"treeKeyFieldName"===u){var f=e.find(function(e){return e.primaryKey});void 0!==f&&(d=f.fieldName)}console.log("showFieldName",d),console.log("showFieldName target",u),this.setData2config(d,u)}}catch(m){a=!0,o=m}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},autoSetColNumber:function(){var e=this,t=this.solutionObj;"subForm4formPage"===t.key&&(k["a"].$on("formPanelUuid",function(t){e.formPanelUuid=t}),k["a"].$emit("requestFormPanelUuid"))},bindTableNameAutoSetter:function(){var e=this,t=this.moduleConfig.uuid;k["a"].$on("setTableName4abstractPanel_".concat(t),function(t){console.log("自动切换表名已触发"),e.tableNameChanged(t)})}}),computed:Object(r["a"])({},j({configMap:function(e){return e.preview.moduleConfigMap}}),N({formConfigMap:function(e){return e.form.moduleConfigMap}}),S({pageTableName:function(e){return e.currentTableName},pageColumns:function(e){return e.columns}}),{colNumber:function(){var e=this.formConfigMap,t=this.formPanelUuid;return e&&t&&e[t]?e[t].metadata.colNumber:1},listTableName:function(){var e=this.configMap,t=this.strategy,n=e[t.uuid]["metadata"][t.strategy.target];return n},columnStrategys:function(){var e=this.strategy,t=e.strategy.children;return t&&t.length>0?t.filter(function(e){return"columns"===e.type}):[]},fieldStrategys:function(){var e=this.strategy,t=e.strategy.children;return t&&t.length>0?t.filter(function(e){return"field"===e.type}):[]}}),watch:{listTableName:{handler:function(e){!this.newSolution&&e&&this.loadColumns(e),this.solutionObj&&"multiSubForm4formPage"===this.solutionObj.key&&this.tableNameChanged(e)},immediate:!0},colNumber:{handler:function(e){var t=this.strategy,n=this.configMap,a=t.uuid,o=n[a];o&&(o.metadata.colNumber=e)},immediate:!0}},components:{columnListSelectorPlus:y["a"]},props:{modelMap:{type:Object,default:function(){}},solutionObj:{type:Object,default:function(){}},strategy:{type:Object,default:function(){}},moduleConfig:{type:Object,default:function(){}},propsSetter:{type:Function,default:void 0},newSolution:{type:Boolean,default:!0},projectType:{type:String,required:!0}},created:function(){var e=this.solutionObj,t=this.strategy,n=this.configMap,a=e.valueGetterFunc,o=a.showSearch;if(void 0!==o&&o.getDefaultValue){var i=t.uuid;n[i]["metadata"]["showSearch"]=o.getDefaultValue()}this.loadTables(),this.autoSetColNumber(),this.bindTableNameAutoSetter()},destroyed:function(){var e=this.moduleConfig.uuid;k["a"].$off("setTableName4abstractPanel_".concat(e))}},D=L,M=n("2877"),E=Object(M["a"])(D,b,v,!1,null,"0345da4c",null),I=E.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form-model",{ref:"form",attrs:{layout:"horizontal",rules:e.rules,"label-col":{span:6},"wrapper-col":{span:18},model:this}},[n("h3",{staticClass:"title"},[e._v("表格配置")]),n("a-form-model-item",{attrs:{label:"默认行数",prop:"defaultLineCount"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:100,placeholder:"请输入默认行数"},model:{value:e.defaultLineCount,callback:function(t){e.defaultLineCount=t},expression:"defaultLineCount"}})],1),n("a-form-model-item",{attrs:{label:"最小行数",prop:"minLineCount"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:100,placeholder:"请输入最小行数"},model:{value:e.minLineCount,callback:function(t){e.minLineCount=t},expression:"minLineCount"}})],1),n("a-form-model-item",{attrs:{label:"最大行数",prop:"maxLineCount"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:100,placeholder:"请输入最大行数"},model:{value:e.maxLineCount,callback:function(t){e.maxLineCount=t},expression:"maxLineCount"}})],1),n("a-form-model-item",{attrs:{label:"宽度策略"}},[n("a-radio-group",{model:{value:e.widthConfig.mode,callback:function(t){e.$set(e.widthConfig,"mode",t)},expression:"widthConfig.mode"}},[n("a-radio-button",{attrs:{value:"percent"}},[e._v("\n        百分比均分\n      ")]),n("a-radio-button",{attrs:{value:"custom"}},[e._v("\n        固定宽度\n      ")])],1)],1),"custom"===e.widthConfig.mode?n("a-form-model-item",{attrs:{label:"每列宽度"}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"表格每列宽度"},model:{value:e.widthConfig.width,callback:function(t){e.$set(e.widthConfig,"width",t)},expression:"widthConfig.width"}})],1):e._e()],1)},$=[],R=Object(g["a"])("panelDesigner"),A=R.mapState,W=R.mapMutations,q={methods:Object(r["a"])({},W(["setModuleConfig"]),{setData2config:function(e,t){var n=this.configMap,a=this.strategy,o=a.uuid,i=n[o];if(void 0!==i&&void 0!==i.metadata){var r=i.metadata;r[t]=e,this.setModuleConfig({key:"preview",uuid:o,config:i})}},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}),computed:Object(r["a"])({},A({configMap:function(e){return e.preview.moduleConfigMap}})),props:{modelMap:{type:Object,default:function(){}},solutionObj:{type:Object,default:function(){}},strategy:{type:Object,default:function(){}},moduleConfig:{type:Object,default:function(){}},propsSetter:{type:Function,default:void 0},newSolution:{type:Boolean,default:!0}}},U={name:"DynamicTableDisplayConfig",data:function(){return{rules:{}}},computed:{defaultLineCount:{get:function(){var e=this.configMap,t=this.strategy,n=e[t.uuid]["metadata"][t.strategy.targetMap.defaultLineCount];return n},set:function(e){var t=this.strategy;this.setData2config(e,t.strategy.targetMap.defaultLineCount)}},minLineCount:{get:function(){var e=this.configMap,t=this.strategy,n=e[t.uuid]["metadata"][t.strategy.targetMap.minLineCount];return n},set:function(e){var t=this.strategy;this.setData2config(e,t.strategy.targetMap.minLineCount)}},maxLineCount:{get:function(){var e=this.configMap,t=this.strategy,n=e[t.uuid]["metadata"][t.strategy.targetMap.maxLineCount];return n},set:function(e){var t=this.strategy;this.setData2config(e,t.strategy.targetMap.maxLineCount)}},widthConfig:{get:function(){var e=this.configMap,t=this.strategy,n=e[t.uuid]["metadata"][t.strategy.targetMap.widthConfig];return n},set:function(e){var t=this.strategy;this.setData2config(e,t.strategy.targetMap.widthConfig)}}},mixins:[q]},z=U,B=(n("5903"),Object(M["a"])(z,P,$,!1,null,"17c4be1a",null)),V=B.exports,G=n("01bc"),K=n("381a"),H=n.n(K),Y=Object(g["a"])("database"),J=Y.mapState,Q=Object(g["a"])("panelDesigner"),X=Q.mapState,Z=Q.mapMutations,ee={name:"AbstractPanelConfig",data:function(){return{moduleList:[],abstractStrategys:[],solutionObj:{},modelMap:void 0,isNewSolution:!1}},methods:Object(r["a"])({},Z(["batchAddConfigMap"]),{propsSetter:function(e,t){t.mainTableName=this.currentTableName;var n=this.solutionObj.propsSetter;n&&n(e,t)},onIntegrationChanged:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,a,o,i,r,l,c,s,d,f,m,h,g,b,v,y,C,w,k,_,x,S=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(void 0===t||this.abstractStrategys.length>0)){e.next=2;break}return e.abrupt("return",!1);case 2:return n=t.panelCode,a=t.execFuncList,o=t.modelGetterList,i=t.containerConfigAutoSetter,e.next=5,this.loadPanelInfo(n);case 5:if(!(a&&a.length>0)){e.next=34;break}r=!0,l=!1,c=void 0,e.prev=9,s=regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=f.value,n=u.find(function(e){return e.name===t}),void 0!==n){e.next=4;break}return e.abrupt("return","continue");case 4:if(!n.func){e.next=7;break}return e.next=7,n.func();case 7:case"end":return e.stop()}},e)}),d=a[Symbol.iterator]();case 12:if(r=(f=d.next()).done){e.next=20;break}return e.delegateYield(s(),"t0",14);case 14:if(m=e.t0,"continue"!==m){e.next=17;break}return e.abrupt("continue",17);case 17:r=!0,e.next=12;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e["catch"](9),l=!0,c=e.t1;case 26:e.prev=26,e.prev=27,r||null==d.return||d.return();case 29:if(e.prev=29,!l){e.next=32;break}throw c;case 32:return e.finish(29);case 33:return e.finish(26);case 34:if(h={},!(o&&o.length>0)){e.next=66;break}g=this.relationInfo,b={relationInfo:g},v=!0,y=!1,C=void 0,e.prev=41,w=regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=_.value,n=p.find(function(e){return e.name===t}),void 0!==n){e.next=4;break}return e.abrupt("return","continue");case 4:if(!n.func){e.next=10;break}return e.next=7,n.func(b);case 7:a=e.sent,console.log("model getter result",a),h[t]=a;case 10:case"end":return e.stop()}},e)}),k=o[Symbol.iterator]();case 44:if(v=(_=k.next()).done){e.next=52;break}return e.delegateYield(w(),"t2",46);case 46:if(x=e.t2,"continue"!==x){e.next=49;break}return e.abrupt("continue",49);case 49:v=!0,e.next=44;break;case 52:e.next=58;break;case 54:e.prev=54,e.t3=e["catch"](41),y=!0,C=e.t3;case 58:e.prev=58,e.prev=59,v||null==k.return||k.return();case 61:if(e.prev=61,!y){e.next=64;break}throw C;case 64:return e.finish(61);case 65:return e.finish(58);case 66:console.log("solutionObj",this.solutionObj),console.log("modelMap",h),this.modelMap=h,this.moduleConfig.metadata.moduleList=this.moduleList,i&&"function"===typeof i&&this.$nextTick(function(){var e=S.projectType,t={projectType:e};i(S.moduleConfig,t)});case 71:case"end":return e.stop()}},e,this,[[9,22,26,34],[27,,29,33],[41,54,58,66],[59,,61,65]])}));function t(t){return e.apply(this,arguments)}return t}(),loadPanelInfo:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,a,o,i,r,l,s,u,d,m,p,h,g;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=this.projectType,t=t.replace("#{projectType}",n),e.next=4,c["a"].get("/diboot/devtools/pnds/pnif/".concat(t));case 4:if(a=e.sent,0!==a.code||!a.data){e.next=21;break}if(o=a.data,i=o.configData,r=JSON.parse(i),l=r.default.moduleConfigMap,s=r.preview.moduleConfigMap,u=r.moduleList,d=r.abstractStrategys,m={},this.isNewSolution){for(p in this.resetPanelUuid(d,u,l),s)s[p].preview=!0;f.a.merge(m,l),f.a.merge(m,s),this.batchAddConfigMap({key:"preview",configMap:m})}else this.replaceUuid4list(d),this.replaceUuid4list(u);return this.moduleList=u,this.abstractStrategys=d,e.next=18,this.nextTick();case 18:this.isNewSolution&&(this.moduleConfig.scriptConfig.props=Object(G["d"])(o),this.moduleConfig.scriptConfig.event=Object(G["b"])(o),h=this.moduleConfig.scriptConfig,this.moduleConfig.metadata.panelConfig.scriptConfig=h,g=this.solutionObj.panelConfigMapAutoSetter,void 0!==g&&"function"===typeof g&&g(m)),e.next=22;break;case 21:this.$message.warning("未获取到当前解决方案的策略信息");case 22:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),resetPanelUuid:function(e,t,n){var a={},o=!0,i=!1,r=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var s=l.value,u=s.uuid,d=H()(16,{numbers:!1});s.uuid=d,a[u]=d}}catch(k){i=!0,r=k}finally{try{o||null==c.return||c.return()}finally{if(i)throw r}}for(var f in a){var m=a[f],p=n[f];void 0!==p&&(n[m]=p,delete n[f])}var h=!0,g=!1,b=void 0;try{for(var v,y=e[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var C=v.value,w=C.uuid;w&&a[w]&&(C.uuid=a[w])}}catch(k){g=!0,b=k}finally{try{h||null==y.return||y.return()}finally{if(g)throw b}}this.moduleConfig.metadata.uuidMap=a},replaceUuid4list:function(e){var t=this.moduleConfig.metadata.uuidMap;if(t&&e&&e.length>0){var n=!0,a=!1,o=void 0;try{for(var i,r=e[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value,c=l.uuid;c&&t[c]&&(l.uuid=t[c])}}catch(s){a=!0,o=s}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}}},nextTick:function(){var e=this;return new Promise(function(t){e.$nextTick(function(){t()})})}}),components:{tableAndColumnsCascadeSelector:I,dynamicTableDisplayConfig:V},computed:Object(r["a"])({},J({currentTableName:function(e){return e.currentTableName},relationInfo:function(e){return e.relationInfo}}),X({panelConfigMap:function(e){return e.preview.moduleConfigMap}})),watch:{"moduleConfig.metadata.moduleObj":{handler:function(e){var t=e.checkFunc;if(void 0!==t&&"function"===typeof t)this.isNewSolution=!0,this.solutionObj=e,this.onIntegrationChanged(e);else{this.isNewSolution=!1;var n=h["a"].find(function(t){return e.key===t.key});this.solutionObj=n,this.onIntegrationChanged(n)}},deep:!0,immediate:!0}},mixins:[l["a"]]},te=ee,ne=(n("c40b"),Object(M["a"])(te,a,o,!1,null,"00b099aa",null));t["default"]=ne.exports}}]);