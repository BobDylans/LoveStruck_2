(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["designerModuleConfig0~designerModuleConfig1~designerModuleConfig10~designerModuleConfig11~designerMo~693c3c65"],{"11ea":function(e,t,n){},"1ca6":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-kit"},[e.scriptConfig.event&&e.scriptConfig.event.length>0?n("a-collapse",{attrs:{"default-active-key":"0",bordered:!1},model:{value:e.panelActiveKey,callback:function(t){e.panelActiveKey=t},expression:"panelActiveKey"}},[e._l(e.scriptConfig.event,function(t,i){return[n("a-collapse-panel",{key:"event_panel_"+i,staticStyle:{"padding-left":"0"},attrs:{header:"@"+t.key+"("+t.params.map(function(e){return e.key}).join(", ")+")"}},[n("a-row",[n("a-col",{attrs:{span:18,offset:2}},[n("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"未启用"},model:{value:t.open,callback:function(n){e.$set(t,"open",n)},expression:"eve.open"}})],1)],1),t.open?n("a-popover",{attrs:{placement:"left",title:"@"+t.key+" 事件绑定",trigger:"click"}},[n("div",{staticStyle:{width:"600px",height:"400px"},attrs:{slot:"content"},slot:"content"},[n("smart-code-editor",{attrs:{code:e.code,workspace:e.workspace,"param-value-getter":function(n){return e.paramValueGetter(n,t.params,t.handlerCode)}},on:{input:function(n){return e.onHandlerCodeChange(n,t)}},model:{value:t.handlerCode,callback:function(n){e.$set(t,"handlerCode",n)},expression:"eve.handlerCode"}})],1),n("a-button",{staticStyle:{margin:"10px 0"},attrs:{block:"",type:"primary",size:"small"}},[e._v("\n            编辑事件函数\n          ")])],1):e._e()],1)]})],2):[e._v("\n    无\n  ")]],2)},a=[],l=(n("28a5"),n("4917"),n("788b")),o=n("541c"),s={name:"EventKit",data:function(){return{panelActiveKey:"event_panel_0"}},methods:{paramValueGetter:function(e,t,n){var i="";if(t&&t.length>0&&n){for(var a,l=0;l<t.length;l++)if(t[l].type===e.type){a=l;break}if(void 0===a)return"";var o=/[^(][a-zA-Z0-9]+(?=\))/,s=n.match(o);if(0===!s.length)return"";var r=s[0].split(",");if(r.length<=a)return"";i=r[a].trim()}return i},onHandlerCodeChange:function(e,t){t.handlerFuncName=Object(o["a"])(e)}},components:{smartCodeEditor:l["a"]},props:{workspace:{type:String,default:"panelDesigner"},code:{type:String,default:""},scriptConfig:{type:Object,default:function(){return{}}},extraMethodObjList:{type:Array,default:function(){return[]}}}},r=s,u=(n("8d31"),n("2877")),c=Object(u["a"])(r,i,a,!1,null,"00f37324",null);t["a"]=c.exports},"32f7":function(e,t,n){"use strict";var i=n("640a"),a=n.n(i);a.a},4047:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h3",{staticClass:"title separator"},[e._v("\n    "+e._s(e.title)+"\n    "),n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",ghost:"",size:"small",title:"更改所有的显示标签",icon:"edit"},on:{click:e.showAllEdit}})],1),[e.resultColumns?n("draggable",{attrs:{element:"div",handle:".drag-handle",options:{group:{name:"columns",pull:"false",put:!1},sort:!0,forceFallback:!0}},model:{value:e.resultColumns,callback:function(t){e.resultColumns=t},expression:"resultColumns"}},e._l(e.resultColumns,function(t,i){return n("div",{key:i,staticClass:"row-container"},[n("a-row",{staticClass:"config-form-item"},[n("a-col",{attrs:{span:2}},[n("span",{staticClass:"col-icon-span drag-handle",attrs:{title:"拖拽可排序"}},[n("a-icon",{staticStyle:{fontSize:"20px"},attrs:{type:"bars"}})],1)]),n("a-col",{attrs:{span:e._f("anotherColSpan")(e._f("btnColSpan")(4,t,e.isExpand,e.expandColumnsFilter),2)}},[t.showInput?n("a-input",{attrs:{id:e.voType+"FieldNameEditInput_"+t.fieldName,size:"small"},on:{keyup:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.saveEdit(t)},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:e.cancelEdit(t)}]},model:{value:t.editFieldLabel,callback:function(n){e.$set(t,"editFieldLabel",n)},expression:"col.editFieldLabel"}},[n("template",{slot:"addonAfter"},[n("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close",title:"关闭"},on:{click:function(n){return e.cancelEdit(t)}}}),n("a-divider",{attrs:{type:"vertical"}}),n("a-icon",{staticStyle:{color:"#2198f7",cursor:"pointer"},attrs:{type:"check",title:"保存"},on:{click:function(n){return e.saveEdit(t)}}})],1)],2):n("p",{staticClass:"icon-small-line"},[n("span",{staticStyle:{"padding-right":"2px"}},[e._v("\n                "+e._s(t.fieldLabel)+"\n              ")]),"BindEntity"===t.refCodeType?n("a-tag",{attrs:{color:"cyan"}},[e._v("\n                对象.字段\n              ")]):e._e(),"BindFieldList"===t.refCodeType?n("a-tag",{attrs:{color:"blue"}},[e._v("\n                对象字段列表\n              ")]):e._e()],1)],1),n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:e._f("btnColSpan")(4,t,e.isExpand,e.expandColumnsFilter)}},[e.isExpand&&(void 0===e.expandColumnsFilter||e.expandColumnsFilter(t))?n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:t.expand?"收起":"展开-更多配置项",icon:t.expand?"up":"down"},on:{click:function(n){return e.toggleColExpand(t)}}}):e._e(),t.showInput?e._e():n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:"更改显示文字",icon:"edit"},on:{click:function(n){return e.showEdit(t)}}}),n("a-button",{staticStyle:{color:"#f36e70"},attrs:{type:"link",size:"small",title:"删除该项",icon:"delete"},on:{click:function(t){return e.removeColumn(i)}}})],1)],1),t.expand?[n("div",{staticClass:"expand-container"},[e._t("item-extra-content",null,{col:t,index:i})],2)]:e._e()],2)}),0):e._e(),n("a-row",[n("a-col",{attrs:{span:"22"}},[e.selectColumns.length>0?n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":e.filterOption,placeholder:"请选择搜索字段"},on:{change:function(t){return e.addColumn(t)}},model:{value:e.addFieldName,callback:function(t){e.addFieldName=t},expression:"addFieldName"}},e._l(e.selectColumns,function(t,i){return n("a-select-option",{key:i,attrs:{value:t.fieldName}},[e._v("\n            "+e._s(t.fieldLabel)+"["+e._s(t.fieldName)+"]\n          ")])}),1):e._e()],1)],1)]],2)},a=[],l=(n("6762"),n("2fdb"),n("ac6a"),n("75fc")),o=(n("7514"),n("2ef0")),s=n.n(o),r=n("3aa3"),u=n("b76a"),c=n.n(u),d={name:"ColumnListSelectorPlus",data:function(){return{resultColumns:[],validColumns:[],addFieldName:void 0,showAllEditFlag:!1}},methods:{initPrimaryKey:function(){if(!this.primaryKeyEvent||!this.columns||0===this.columns.length)return!1;var e=this.columns.find(function(e){return!0===e.primaryKey}),t=void 0===e?"id":e.fieldName;this.$emit("primaryKeyChange",t)},initValidColumns:function(){var e=this;if(this.columns&&this.columns.length>0){var t=this.columns;if(void 0!==this.validColumnsFilter&&(t=this.columns.filter(this.validColumnsFilter)),this.validColumns=s.a.cloneDeep(t),this.appendOtherProperties(this.validColumns),this.voType){var n=this.columns[0]["tableName"];r["a"].get("/diboot/devtools/pcds/vorl/".concat(n,"/").concat(this.voType)).then(function(t){if(0===t.code&&t.data){var n,i=t.data.filter(function(e){return"BindEntity"!==e.refCodeType&&"BindEntityList"!==e.refCodeType});if(e.appendOtherProperties(i),(n=e.validColumns).push.apply(n,Object(l["a"])(i)),e.value.length>0&&0===e.resultColumns.length?e.resultColumns=s.a.cloneDeep(e.value):0===e.resultColumns.length&&e.setValidColumns2ResultColumns(s.a.cloneDeep(e.validColumns)),e.needRefEntity){var a,o=t.data.filter(function(e){return"BindEntity"===e.refCodeType&&void 0!==e.columns&&e.columns.length>0}),r=[];o.forEach(function(e){var t=e.columns.filter(function(e){return"id"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&!e.columnExt.refType}),n=t.map(function(t){return t.fieldName="".concat(e.fieldName,".").concat(t.fieldName),t.fieldLabel="".concat(e.fieldLabel).concat(t.fieldLabel),t.refCodeType=e.refCodeType,t.entityFieldName=e.fieldName,t});r.push.apply(r,Object(l["a"])(n))}),e.appendOtherProperties(r),(a=e.validColumns).push.apply(a,r)}}else e.value.length>0&&0===e.resultColumns.length?e.resultColumns=s.a.cloneDeep(e.value):0===e.resultColumns.length&&e.setValidColumns2ResultColumns(s.a.cloneDeep(e.validColumns))}).catch(function(){e.value.length>0&&0===e.resultColumns.length?e.resultColumns=s.a.cloneDeep(e.value):0===e.resultColumns.length&&e.setValidColumns2ResultColumns(s.a.cloneDeep(e.validColumns))}).finally(function(){e.$emit("freezeColumns",e.resultColumns)})}else this.value.length>0&&0===this.resultColumns.length?this.resultColumns=s.a.cloneDeep(this.value):0===this.resultColumns.length&&this.setValidColumns2ResultColumns(s.a.cloneDeep(this.validColumns)),this.$emit("freezeColumns",this.resultColumns)}},setValidColumns2ResultColumns:function(e){this.resultColumns=this.filterInitColumns2ResultColumns(e)},filterInitColumns2ResultColumns:function(e){var t=this;return e.filter(function(e){return void 0===t.autoSetterColFilter||t.autoSetterColFilter(e)})},setResultColumns:function(e){this.resultColumns=e},addColumn:function(e){var t=this.validColumns.find(function(t){return t.fieldName===e});if(void 0===t)return!1;this.addFieldName=void 0,this.resultColumns.push(t),this.$emit("change",this.resultColumns)},toggleColExpand:function(e){e.expand=!e.expand},removeColumn:function(e){var t=this.resultColumns.splice(e,1);if(t.length>0){var n=t[0],i=this.validColumns.find(function(e){return e.columnExt?e.colName===n.colName:e.fieldName===n.fieldName});if(void 0!==i){var a=this.validColumns.indexOf(i);-1!==a&&(this.validColumns[a]=n)}}this.$emit("change",this.resultColumns)},appendOtherProperties:function(e){var t=this;e.forEach(function(e){e.showInput=!1,e.expand=!1,e.editFieldLabel=e.fieldLabel,void 0!==t.colExtraPropertiesSetter&&t.colExtraPropertiesSetter(e)})},showAllEdit:function(){var e=this;this.showAllEditFlag=!this.showAllEditFlag,this.resultColumns&&this.resultColumns.map(function(t){e.showAllEditFlag?t.showInput=!0:e.cancelEdit(t)})},showEdit:function(e){var t=this;e.showInput=!0,setTimeout(function(){var n=document.getElementById("".concat(t.voType,"FieldNameEditInput_").concat(e.fieldName));n&&n.focus()},200)},cancelEdit:function(e){e.editFieldLabel=e.fieldLabel,e.showInput=!1,this.focusNextColumn(e)},saveEdit:function(e){if(!e.editFieldLabel)return this.$message.error("字段标签名称不可为空"),!1;e.fieldLabel=e.editFieldLabel,e.showInput=!1,this.$emit("change",this.resultColumns),this.$forceUpdate(),this.focusNextColumn(e)},focusNextColumn:function(e){var t=this.resultColumns.indexOf(e)+1;if(t>0&&t<this.resultColumns.length){var n=this.resultColumns[t];n.showInput?document.getElementById("".concat(this.voType,"FieldNameEditInput_").concat(n.fieldName)).focus():this.focusNextColumn(n)}},changed:function(){this.$emit("change",this.resultColumns)},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}},filters:{btnColSpan:function(e,t,n,i){return e=e||4,n&&(e+=2),void 0===i||i(t)||(e-=2),t.showInput||(e+=2),e},anotherColSpan:function(e,t){return 24-e-t}},computed:{columns:function(){return this.initColumns?this.initColumns:this.$store.state.database.columns},selectColumns:function(){if(void 0===this.resultColumns)return[];var e=this.resultColumns.map(function(e){return e.fieldName});return this.validColumns.filter(function(t){return!e.includes(t.fieldName)})}},watch:{columns:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()},resultColumns:{handler:function(e){this.$emit("change",e)},deep:!0}},components:{draggable:c.a},props:{title:{type:String,default:"数据项配置"},isExpand:{type:Boolean,default:!0},voType:{type:String,default:""},value:{type:Array,default:function(){return[]}},colExtraPropertiesSetter:{type:Function,default:function(){}},expandColumnsFilter:{type:Function,default:void 0},validColumnsFilter:{type:Function,default:void 0},autoSetterColFilter:{type:Function,default:void 0},needRefEntity:{type:Boolean,default:!0},initColumns:{type:Array,default:void 0},primaryKeyEvent:{type:Boolean,default:!1}},created:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()}},f=d,p=(n("32f7"),n("2877")),m=Object(p["a"])(f,i,a,!1,null,"dd63a236",null);t["a"]=m.exports},"541c":function(e,t,n){"use strict";n.d(t,"a",function(){return i});n("28a5");var i=function(e){if(!e)return"";var t=e.slice(0,e.indexOf("(")).split(" ");return 1===t.length?t[0].trim():t[t.length-1].trim()}},"640a":function(e,t,n){},"7f57":function(e,t,n){"use strict";n("ac6a");var i=n("cebc"),a=n("2ef0"),l=n.n(a),o=n("1ca6"),s=n("2f62"),r=(n("96cf"),n("3b8d")),u=Object(s["a"])("panelDesigner"),c=u.mapState,d=u.mapMutations,f={methods:Object(i["a"])({},d(["completeValidate","addValidateMsg"]),{validate:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.uuid,console.log("start validate module",t),e.next=4,this.formValidate();case 4:if(n=e.sent,console.log("module valid",n),n){e.next=10;break}return this.addValidateMsg({uuid:t}),this.completeValidate({uuid:t}),e.abrupt("return",!1);case 10:return e.next=12,this.customValidate();case 12:if(n=e.sent,this.completeValidate({uuid:t}),n){e.next=17;break}return this.addValidateMsg({uuid:t}),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),formValidate:function(){var e=this;return new Promise(function(t){var n=e.$refs.form;console.log("form validate ref",n),n?n.validate(function(e){t(e)}):t(!0)})},customValidate:function(){return new Promise(function(e){return e(!0)})}}),computed:Object(i["a"])({},c({validateInfo:function(e){return e.validateInfo},configMap:function(e){return e.default.moduleConfigMap}})),watch:{"validateInfo.currentModuleId":{handler:function(e){console.log("validateInfo.currentModuleId",e),console.log("validateInfo.currentModuleId uuid",this.uuid),e===this.uuid&&this.validate()},deep:!0}}},p=Object(s["a"])("panelDesigner"),m=p.mapState,h=p.mapMutations;t["a"]={data:function(){return{workspace:"panelDesigner"}},methods:Object(i["a"])({},h(["updateModuleConfigList","updateConfigMap","clearAbstractStrategys","clearAllAbstractStrategys","addAbstractStrategy","addAbstractStrategys"]),{filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},getAbstractStrategys:function(){return[]}}),computed:Object(i["a"])({},m({abstractPanel:function(e){return e.abstractPanel}}),{moduleConfig:{get:function(){var e=this.$store.state.panelDesigner[this.code].moduleConfigMap;return e[this.uuid]},set:function(e){var t=this.$store.state.panelDesigner[this.code].moduleConfigMap;t[this.uuid];l.a.cloneDeep(e),this.updateConfigMap({key:this.code,configMap:t})}}}),watch:{abstractPanel:{handler:function(e){if(e){var t=this.uuid,n=this.getAbstractStrategys(),i=l.a.cloneDeep(n);i.forEach(function(e){e.uuid=t}),this.addAbstractStrategys(i)}else this.clearAllAbstractStrategys()},immediate:!0}},mixins:[f],components:{eventKit:o["a"]},props:{uuid:{type:String,required:!0},code:{type:String,required:!0},projectType:{type:String,required:!0}}}},"8d31":function(e,t,n){"use strict";var i=n("11ea"),a=n.n(i);a.a},e5b5:function(e,t,n){"use strict";var i=n("cebc"),a=n("2ef0"),l=n.n(a),o=n("2f62"),s=n("1ca6"),r=n("80da"),u=Object(o["a"])("DragConfig"),c=u.mapMutations;t["a"]={data:function(){return{workspace:"DragConfig"}},methods:Object(i["a"])({},c(["updateModuleConfigList","updateConfigMap"])),computed:{moduleConfig:{get:function(){var e=this.$store.state.DragConfig[this.code].moduleConfigMap;return e[this.uuid]},set:function(e){var t=this.$store.state.DragConfig[this.code].moduleConfigMap;t[this.uuid];l.a.cloneDeep(e),this.updateConfigMap({key:this.code,configMap:t})}}},components:{eventKit:s["a"]},mixins:[r["a"]],props:{uuid:{type:String,required:!0},code:{type:String,required:!0},projectType:{type:String,required:!0}}}}}]);